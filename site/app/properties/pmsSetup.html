<Style>
    .floorplan {
        border: 1px solid #ccc;
        margin:5px 0px;
        padding: 0px 5px;
        cursor: move;
    }

    .floorplan.biradix {
        background-color:gold
    }

    .floorplan.unmapped {
        background-color:cyan
    }

    .floorplan.mapped {
        background-color:cyan;
    }

    .list {
        border: 2px dashed #ccc;
        width:100%;
        min-height:30px;
        padding:5px;
    }

</Style>
<div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-label="Close" ng-click="cancel()"><span aria-hidden="true">&times;</span></button>
    <h2 class="modal-title">PMS Integration: {{property.name}}</h2>
    <hr>
</div>
<div class="modal-body">
    <p class="mb-20" ng-if="!pmsData.isConnected">Use this wizard to Connect <b>{{property.name}}</b> to a PMS and enable importing data into New Property Surveys.</p>
    <div ng-if="loading" style="display:block;width:100px;margin:20px auto">
        <img src="/images/squares.gif" style="width:100px">
    </div>
    <div ng-if="!loading">
        <form ng-if="imports.length === 1">
            <div class="form-group">
                <label>What property do you want to connect to?<span class="required">*</span></label>
                <div ng-if="!pms.config.importId" ng-model="pms.selectedProperty" custom-select="property.name for property in properties | filter: $searchTerm"></div>
                <div ng-if="pms.config.importId">Connected to: <b>{{pms.selectedProperty.name}}</b> - <A href ng-click="disconnect()">Disconnect</A></div>
            </div>

            <div ng-if="pms.config.importId">
                <h4>BI:Radix Floor plans:</h4>
                <div ng-repeat-start="floorplan in pms.floorplans"></div>
                <div class="floorplan biradix">{{floorplan.name}}</div>
                <ul ui-sortable="{connectWith: '.list'}" ng-model="floorplan.yardi" class="list">
                    <div ng-repeat="mapped in floorplan.yardi | filter" class="floorplan mapped"><i class="fa fa-bars"></i> {{mapped.name}}</div>
                </ul>
                <div ng-repeat-end ng-if="false"></div>
                <h4>Unmapped Yardi Floor plans:</h4>
                <ul ui-sortable="{connectWith: '.list'}" ng-model="pms.unmappedFloorplans" class="list">
                    <div ng-repeat="floorplan in pms.unmappedFloorplans" class="floorplan unmapped"><i class="fa fa-bars"></i> {{floorplan.name}}</div>
                </ul>
                <h4>Excluded Yardi Floor plans:</h4>
                <ul ui-sortable="{connectWith: '.list'}" ng-model="pms.excludedFloorplans" class="list">
                    <div ng-repeat="floorplan in pms.excludedFloorplans" class="floorplan unmapped"><i class="fa fa-bars"></i> {{floorplan.name}}</div>
                </ul>

            </div>
        </form>
        <div class="alert alert-warning" role="alert" ng-if="imports.length === 0"><b>There are no PMS Integrations configured for your organization.</b></div>
        <div class="alert alert-danger" role="alert" ng-if="imports.length > 1"><b>There are multiple PMS Integrations configured for your organization.</b></div>

    </div>
</div>
<div ng-if="!loading" class="modal-footer" style="text-align: center">
    <button ng-if="pms.selectedProperty && !pms.config.importId" class="btn btn-warning contact-submit" ng-click="connect()">Connect</button>
    <button ng-if="pms.config.importId" class="btn btn-warning contact-submit" ng-click="bestmatch()">Map Best Match</button>
</div>
